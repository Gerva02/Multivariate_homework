---
title: "Homework_multivariate"
output: pdf_document
date: "2025-03-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(GGally)
library(tidyverse)
```


```{r}
library(MASS)
X<-tibble(Boston[,-c(2,4,9,14)])
?Boston
head(X)
n= ncol(X)
```
2.
We will print all of the correlations 
we get the lower part of the matrix(it's symmetric) (exluding ones), we take the absolute values and we sort then take the biggest five correlation 

```{r}
S = cor(X)
b = S[lower.tri(S)]%>% abs() %>% sort( decreasing = T) %>% .[1:4]
indices <- (matrix( abs(S) %in% b , ncol=n ) & lower.tri(S)) %>% which( arr.ind = TRUE)

result_table <- tibble(
  Var1 = rownames(S)[indices[, 1]],
  Var2 = colnames(S)[indices[, 2]],
  Correlation = S[indices]
)

print(result_table)
```
The first intepretation is obvious areas that highly industrialized emit momre nitrogen oxides
the second i dont know (why would proportion of owner-occupied units built prior to 1940.

and nitrogen corelate)
the third is easy more rural areas have less pollution 

the fourth is not clear to 


extreme univariate outlier we try with box plots

```{r}
X%>% scale() %>% boxplot()

```


```{r}
X %>%  
  ggpairs(  lower = list(
    continuous = function(data, mapping, ...) {
      ggplot(data = data, mapping = mapping) +
        geom_point() +
        stat_ellipse()
    })
    ) 
  
```


